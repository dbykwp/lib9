#%RAML 1.0
title: "TFT Grid capacity"
description: API of the TFT grid, used to register/track the capacity available on the grid
version: 0.0.1
mediaType: application/json

types:
  Location:
    properties:
      continent: string
      country: string
      city: string
      latitude: number
      longitude: number
  Capacity:
    description: |
      Capacity of a node
    properties:
      node_id:
        type: string
      farmer:
        type: string
        description: ID of the farmer owning the node
        required: false
      os_version:
        type: string
        description: branch and revision of 0-OS
      location:
        required: false
        type: Location
      robot_address:
        type: string
        description: URL to the node 0-robot of the node
      cru:
        type: number
        description: amount of CPU resource unit
      mru:
        type: number
        description: amount of memory resource unit
      hru:
        type: number
        description: amount of HDD resource unit
      sru:
        type: number
        description: amount of SSD resource unit
      uptime:
        type: integer
        description: uptime of the node in seconds
        required: false
    example:
      node_id: 544546f60261
      farmer: JohnDoe
      os_version: "heads/v1.2.2 6b693a496de940b26ee1a2356b67f7d65767c13f"
      robot_address: "http://10.241.100.10:6600"
      cru: 5
      mru: 64
      hrd: 5000
      sru: 256
      uptime: 92682
      location:
        continent: Europe
        country: Belgium
        city: Brussels
        latitude: 50.83
        longitude: 4.29
  Farmer:
    properties:
      iyo_organization:
        type: string
      name:
        type: string
      wallet_addresses:
        type: string[]

  Error:
    properties:
      code:
        type: integer
        description: error code
      message:
        type: string
        description: Human friendly error message
      stack_trace:
        type: string
        description: optional stack_trace attached with the error.
        required: false
/api:
  /nodes:
    post:
      displayName: RegisterCapacity
      description: Register a node capacity
      body:
        type: Capacity
      responses:
        201:
          body:
            type: Capacity

    get:
      displayName: ListCapacity
      description: List all the nodes capacity
      queryString:
        properties:
          country?: string
          cru?: number
          mru?: number
          sru?: number
          farmer?: string
      responses:
        200:
          body:
            type: Capacity[]
    
    /beat:
      post:
        displayName: RecordCapacityBeat
        description: Record capacity beat
        body:
          type: Capacity
        responses:
          201:
            body:
              type: Capacity

    /{node_id}:
      get:
        displayName: GetCapacity
        description: Get detail about capacity of a node
        responses:
          200:
            body:
              type: Capacity



  /farmer_create:
    get:
      displayName: RegisterFarmer
      description: Register a farmer
      queryString:
        properties:
          organization: string
          name: string
      responses:
        302:
          description: Page with information how to use your farm


  /farmer_update:
    get:
      displayName: UpdateFarmer
      description: Update a farmer
      queryString:
        properties:
          organization: string
      responses:
        302:
          description: Page with all the farmers
  /farmers:
    get:
      displayName: ListFarmers
      description: List Farmers
      responses:
        200:
          body:
            type: Farmer[]
    /{iyo_organization}:
      get:
        displayName: GetFarmer
        description: Get detail about a farmer
        responses:
          200:
            body:
              type: Farmer